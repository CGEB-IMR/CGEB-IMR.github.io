(window.webpackJsonpqueuejs=window.webpackJsonpqueuejs||[]).push([[0],{17:function(e,t,n){e.exports=n(45)},45:function(e,t,n){"use strict";n.r(t);var a,r=n(0),l=n.n(r),u=n(9),c=n.n(u),s=n(6),m=n(10),o=n(11),i=n(15),d=n(12),p=n(16),E=n(4),h=n(13);a="https://imr-prod.herokuapp.com/api";var f=function(e){var t=e.status,n=e.show;return n&&"InProgress"===t?l.a.createElement("span",{className:"dotO"},"\u25cf"):n&&"Done"===t?l.a.createElement("span",{className:"dotG"},"\u25cf"):l.a.createElement("span",null,"-")};var y=function(e){var t=e.sampleGroup,n=t.imr_id,a=t.submitted_by,r=t.target,u=t.n_samples,c=t.needs_library,s=t.library_status,m=t.sequencing_status,o=t.needs_analysis,i=t.analysis_status;return l.a.createElement("tr",{key:n},l.a.createElement("td",null,n,a.length?" (".concat(a,")"):""),l.a.createElement("td",null,e.runId),l.a.createElement("td",null,r),l.a.createElement("td",null,u),l.a.createElement("td",null,l.a.createElement(f,{show:c,status:s})),l.a.createElement("td",null,l.a.createElement(f,{show:!0,status:m})),l.a.createElement("td",null,l.a.createElement(f,{show:o,status:i})))};var g=function(e){return[e.sampleGroups.map(function(t){return l.a.createElement(y,{key:t.imr_id,runId:e.runId,sampleGroup:t})}),l.a.createElement("tr",{key:e.runId,style:{backgroundColor:"grey"}},l.a.createElement("td",{colSpan:7,height:"10"}))]},b=n(3),v=n.n(b);function _(e,t){var n=e;return t&&(n=n.filter(function(e){return e.sequencing_platform===t})),n.reduce(function(e,t){return e+t.n_samples},0)}function q(e,t){return e.reduce(function(e,n){return e+_(n.samples,t)},0)}function S(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=new Date;return t?e.filter(function(e){return e.planned_end&&v()(e.planned_end)>n}):e.filter(function(e){return e.planned_end&&v()(e.planned_end)>n||!e.planned_end})}var w={borderCollapse:"collapse",borderSpacing:0};var N=function(e){var t=S(e.runs,!1),n=q(t,"NextSeq"),a=q(t,"PacBio");return l.a.createElement("table",{className:"queueT",style:w},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",{colSpan:7},"Queued for ",l.a.createElement("span",{style:{color:"red"}},"NextSeq"),"\xa0(",n,") & ",l.a.createElement("span",{style:{color:"red"}},"PacBio"),"\xa0(",a,")")),l.a.createElement("tr",null,l.a.createElement("th",null),l.a.createElement("th",null,"Run"),l.a.createElement("th",null,"Target"),l.a.createElement("th",null,"#"),l.a.createElement("th",null,"Libr."),l.a.createElement("th",null,"Seq."),l.a.createElement("th",null,"Anal.")),e.runs.map(function(e){return l.a.createElement(g,{key:"sg"+e.run_id,runId:e.run_id,sampleGroups:e.samples})})))},G={table:{width:"60%",borderCollapse:"collapse",borderSpacing:0},emptyRow:{textAlign:"center"}};var R=function(e){var t=Object(E.orderBy)(e.runs.filter(function(e){return e.planned_start}),"planned_start","desc");return l.a.createElement("table",{className:"queueT",style:G.table},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",{colSpan:4},"Upcoming ",l.a.createElement("span",{style:{color:"red"}},e.platformName)," Runs")),l.a.createElement("tr",null,l.a.createElement("th",null,"Run"),l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"#"),l.a.createElement("th",null,"Planned Dates")),t.length?t.map(function(e){return l.a.createElement("tr",{key:e.run_id},l.a.createElement("td",null,e.run_id),l.a.createElement("td",null,e.run_type),l.a.createElement("td",null,e.n_samples),l.a.createElement("td",null,v()(e.planned_start).format("MMM. D"),"\xa0\u2013\xa0",v()(e.planned_end).format("MMM. D")))}):l.a.createElement("tr",null,l.a.createElement("td",{colSpan:4,style:G.emptyRow},"No upcoming ",e.platformName," runs."))))},k={borderCollapse:"collapse",borderSpacing:0};var j=function(e){var t=q(S(e.runs,!1));return l.a.createElement("table",{className:"queueT",style:k},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",{colSpan:7},"Queued for ",l.a.createElement("span",{style:{color:"red"}},e.platformName),"\xa0(",t,")")),l.a.createElement("tr",null,l.a.createElement("th",null),l.a.createElement("th",null,"Run"),l.a.createElement("th",null,"Target"),l.a.createElement("th",null,"#"),l.a.createElement("th",null,"Libr."),l.a.createElement("th",null,"Seq."),l.a.createElement("th",null,"Anal.")),e.runs.map(function(e){return l.a.createElement(g,{key:"sg"+e.run_id,runId:e.run_id,sampleGroups:e.samples})})))};var x=function(e){var t=e.sampleGroup;return l.a.createElement("tr",{key:t.imr_id},l.a.createElement("td",null,t.imr_id,t.submitted_by.length?" (".concat(t.submitted_by,")"):""),l.a.createElement("td",null,t.target),l.a.createElement("td",null,t.n_samples))};var M=function(e){return e.sampleGroups.map(function(e){return l.a.createElement(x,{key:e.imr_id,sampleGroup:e})})},O={borderCollapse:"collapse",borderSpacing:0};var I=function(e){var t=_(e.sampleGroups);return l.a.createElement("table",{className:"queueT",style:O},l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("th",{colSpan:7},l.a.createElement("span",{style:{color:"red"}},"Samples Received")," (",t,")")),l.a.createElement("tr",null,l.a.createElement("th",null),l.a.createElement("th",null,"Target"),l.a.createElement("th",null,"#")),l.a.createElement(M,{sampleGroups:e.sampleGroups})))},T={textAlign:"center",fontWeight:"400",fontSize:"x-large"},A=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(i.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={queues:{},samplesReceived:[],runs:[],loadingSequencingRuns:!0,loadingSampleGroups:!0,error:!1},n.handleError=function(){n.setState({error:!0,loading:!1})},n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;(function(){var e=new Request("".concat(a,"/runs/"));return fetch(e).then(function(e){return e.json()})})().then(function(t){e.setState({runs:t,loadingSequencingRuns:!1})}).catch(this.handleError),function(){var e=new Request("".concat(a,"/sample_groups/"));return fetch(e).then(function(e){return e.json()})}().then(function(t){e.setState({samplesReceived:t,loadingSampleGroups:!1})}).catch(this.handleError)}},{key:"render",value:function(){if(this.state.error)return l.a.createElement("div",null,"There was a problem loading the queue. Please try again later.");var e=this.state.loadingSampleGroups||this.state.loadingSequencingRuns;if(e)return l.a.createElement("div",{style:{textAlign:"center"}},l.a.createElement(h.PulseLoader,{loading:e,color:"#281835"}),l.a.createElement("p",{style:{textAlign:"center"}},"Loading queue..."));var t=this.state,n=t.runs,a=t.samplesReceived,r=q(S(n,!1))+_(a),u=n.filter(function(e){return"MiSeq"===e.queue}),c=n.filter(function(e){return"NextSeq"===e.queue}),m=n.filter(function(e){return"PacBio"===e.queue});return l.a.createElement("div",null,l.a.createElement("div",{style:T},"Current total number of samples/slots committed to queue: \xa0",l.a.createElement("span",{style:{color:"red"}},r),l.a.createElement("br",null)),l.a.createElement("p",null),l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",{align:"center"},l.a.createElement(R,{platformName:"MiSeq",runs:S(u)})),l.a.createElement("td",{align:"center"},l.a.createElement(R,{platformName:"NextSeq",runs:S(c)})),l.a.createElement("td",{align:"center"},l.a.createElement(R,{platformName:"PacBio",runs:S(m)}))))),l.a.createElement("section",null,l.a.createElement("p",null,l.a.createElement("font",{size:"3em"},"Legend:",l.a.createElement("span",{className:"dotO"},"\u25cf")," = in progress/pending;",l.a.createElement("span",{className:"dotG"},"\u25cf")," = completed; Extr. = extracted (either in advance by client, or by IMR); Libr. = library prepared; Seq. = sequenced; Anal. = analyzed (if requested).")),l.a.createElement("p",null),l.a.createElement("table",null,l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",{align:"center",style:{width:"32%"}},l.a.createElement(I,{sampleGroups:a.reverse()})),l.a.createElement("td",{style:{width:"2%"}},"\xa0"),l.a.createElement("td",{align:"center",style:{width:"32%"}},l.a.createElement(j,{platformName:"MiSeq",runs:u})),l.a.createElement("td",{style:{width:"2%"}},"\xa0"),l.a.createElement("td",{align:"center",style:{width:"32%"}},l.a.createElement(N,{platformName:"NextSeq",runs:Object(E.orderBy)([].concat(Object(s.a)(c),Object(s.a)(m)),"planned_start")})))))))}}]),t}(r.Component);c.a.render(l.a.createElement(A,null),document.getElementById("queue-app-root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.01e3886e.chunk.js.map